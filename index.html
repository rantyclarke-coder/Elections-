<!DOCTYPE html>
<html>
<head>
  <title>US XXXX Elections</title>
</head>

<body style="background:black; color:white; text-align:center; font-family:Arial;">

  <h1>US XXXX ELECTIONS</h1>

  <div style="display:flex; justify-content:space-around; margin-top:30px;">

    <div>
      <img src="https://via.placeholder.com/200" />
      <h2>BRIXTON</h2>
      <h1 id="brixtonVotes">0</h1>
    </div>

    <div>
      <img src="https://via.placeholder.com/200" />
      <h2>MCKINLEY</h2>
      <h1 id="mckinleyVotes">0</h1>
    </div>

  </div>

  <div style="margin-top:40px; width:80%; margin:auto; position:relative;">

  <!-- BACKGROUND -->
  <div style="height:12px; background:#333; border-radius:6px;"></div>

  <!-- BRIxton BAR -->
  <div id="barB"
       style="height:12px; background:blue; width:0%;
              position:absolute; left:0; top:0; border-radius:6px 0 0 6px;">
  </div>

  <!-- McKinley BAR -->
  <div id="barM"
       style="height:12px; background:red; width:0%;
              position:absolute; right:0; top:0; border-radius:0 6px 6px 0;">
  </div>

  <!-- 270 MARK -->
  <div style="position:absolute; left:50%; top:-18px; font-size:12px;">
    ▲ 270
  </div>

  <p style="margin-top:20px;">538 TOTAL — 270 TO WIN</p>
  </div>

  <div style="margin-top:40px; width:90%; margin:auto;">
    <object id="map" data="us.svg" type="image/svg+xml" style="width:100%;"></object>
  </div>

<script>
  // ===== LIVE DATA SOURCE =====
const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vSsbbXqdgfMGosYWjOVNR-2UUw6bZzjGNtnfuuWpbBuTutk6Jm1lffgHUis8GNjfQLFZLkaSpJNlck2/pub?gid=0&single=true&output=csv";
  // ===== ELECTION LOGIC =====
function computePresidentialResults(data) {
  const evTotals = { C1: 0, C2: 0, C3: 0 };
  const stateWinners = {};

  data.forEach(row => {
    const total = row.c1 + row.c2 + row.c3;
    if (total === 0) return;

    const p1 = row.c1 / total;
    const p2 = row.c2 / total;
    const p3 = row.c3 / total;

    let winner = "C1";
    let max = p1;

    if (p2 > max) { winner = "C2"; max = p2; }
    if (p3 > max) { winner = "C3"; }

    stateWinners[row.state] = winner;
    evTotals[winner] += electoralVotes[row.state] || 0;
  });

  return { stateWinners, evTotals };
}
  // ===== FETCH & PARSE CSV =====
async function fetchPresidentialCSV() {
  const response = await fetch(CSV_URL);
  const text = await response.text();

  const rows = text.trim().split("\n");
  const data = [];

  for (let i = 2; i < rows.length; i++) { // A3 onwards
    const cols = rows[i].split(",");

    const state = cols[0]?.trim();
    if (!state) continue;

    const c1 = Number(cols[11] || 0); // Column L
    const c2 = Number(cols[12] || 0); // Column M
    const c3 = Number(cols[13] || 0); // Column N

    data.push({ state, c1, c2, c3 });
    const results = computePresidentialResults(data);
window.stateWinners = results.stateWinners;
window.evTotals = results.evTotals;
  }

  console.log("PRESIDENTIAL DATA:", data);
}
const states = {
  AL: { votes: 9, owner: null },
  AK: { votes: 3, owner: null },
  AZ: { votes: 11, owner: null },
  AR: { votes: 6, owner: null },
  CA: { votes: 54, owner: null },
  CO: { votes: 10, owner: null },
  CT: { votes: 7, owner: null },
  DE: { votes: 3, owner: null },
  FL: { votes: 30, owner: null },
  GA: { votes: 16, owner: null },
  HI: { votes: 4, owner: null },
  ID: { votes: 4, owner: null },
  IL: { votes: 19, owner: null },
  IN: { votes: 11, owner: null },
  IA: { votes: 6, owner: null },
  KS: { votes: 6, owner: null },
  KY: { votes: 8, owner: null },
  LA: { votes: 8, owner: null },
  ME: { votes: 4, owner: null },
  MD: { votes: 10, owner: null },
  MA: { votes: 11, owner: null },
  MI: { votes: 15, owner: null },
  MN: { votes: 10, owner: null },
  MS: { votes: 6, owner: null },
  MO: { votes: 10, owner: null },
  MT: { votes: 4, owner: null },
  NE: { votes: 5, owner: null },
  NV: { votes: 6, owner: null },
  NH: { votes: 4, owner: null },
  NJ: { votes: 14, owner: null },
  NM: { votes: 5, owner: null },
  NY: { votes: 28, owner: null },
  NC: { votes: 16, owner: null },
  ND: { votes: 3, owner: null },
  OH: { votes: 17, owner: null },
  OK: { votes: 7, owner: null },
  OR: { votes: 8, owner: null },
  PA: { votes: 19, owner: null },
  RI: { votes: 4, owner: null },
  SC: { votes: 9, owner: null },
  SD: { votes: 3, owner: null },
  TN: { votes: 11, owner: null },
  TX: { votes: 40, owner: null },
  UT: { votes: 6, owner: null },
  VT: { votes: 3, owner: null },
  VA: { votes: 13, owner: null },
  WA: { votes: 12, owner: null },
  WV: { votes: 4, owner: null },
  WI: { votes: 10, owner: null },
  WY: { votes: 3, owner: null },
  DC: { votes: 3, owner: null }
};

function updateTotals() {
  let b = 0, m = 0;
  for (let s in states) {
    if (states[s].owner === "B") b += states[s].votes;
    if (states[s].owner === "M") m += states[s].votes;
    document.getElementById("barB").style.width = (b / 538 * 100) + "%";
document.getElementById("barM").style.width = (m / 538 * 100) + "%";
  }
  document.getElementById("brixtonVotes").innerText = b;
  document.getElementById("mckinleyVotes").innerText = m;
}

document.getElementById("map").addEventListener("load", () => {
  const svg = document.getElementById("map").contentDocument;

  for (let id in states) {
    const state = svg.getElementById(id);
    if (!state) continue;

    state.style.fill = "#555";
    state.style.cursor = "pointer";

    state.onclick = () => {
      if (states[id].owner === null) {
        states[id].owner = "B";
        state.style.fill = "blue";
      } else if (states[id].owner === "B") {
        states[id].owner = "M";
        state.style.fill = "red";
      } else {
        states[id].owner = null;
        state.style.fill = "#555";
      }
      updateTotals();
    };
  }
});
  document.addEventListener("DOMContentLoaded", () => {
  fetchPresidentialCSV();
});
</script>

</body>
</html></html>
